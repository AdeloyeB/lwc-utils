<template>
    <c-message-service
        boundary={requestorRecordId}
        onrowselected={handleRowSelected}
        onsetdraftvalue={handleSetDraftValue}
        oncanceldraft={handleCancelDraftValue}
    ></c-message-service>

    <section onmouseenter={toggleShowEditIcon} onmouseleave={toggleShowEditIcon}>
        <lightning-layout horizontal-align="spread" class={calculateLayoutClass}>
            <!-- VIEW MODE -->
            <template if:false={isEditMode}>
                <lightning-layout-item class="slds_truncate">
                    <slot name="valueCell" onslotchange={handleValueCellSlotChange}>
                        <!-- value contents goes here -->
                    </slot>
                </lightning-layout-item>
                <lightning-layout-item flexibility="shrink">
                    <template if:true={showEditIcon}>
                        <lightning-button-icon
                            class="slds-button__icon_hint"
                            icon-name="utility:edit"
                            variant="bare"
                            alternative-text="Edit"
                            onclick={enableEditMode}
                        ></lightning-button-icon>
                    </template>
                </lightning-layout-item>
            </template>
            <template if:true={isEditMode}>
                <div class="slds-dropdown slds-dropdown_left cell-dropdown">
                    <lightning-layout multiple-rows>
                        <lightning-layout-item size="12">
                            <slot name="editCell" onslotchange={handleEditCellSlotChange}>
                                <!-- edit mode lwc goes here -->
                            </slot>
                        </lightning-layout-item>
                        <template if:true={showMassEdit}>
                            <lightning-layout-item size="12">
                                <lightning-input
                                    class="mass-input-checkbox slds-p-bottom_xx-small"
                                    type="checkbox"
                                    label={checkboxLabel}
                                ></lightning-input>
                                <div class="slds-popover__footer">
                                    <lightning-layout horizontal-align="end">
                                        <lightning-button
                                            class="slds-p-right_xx-small"
                                            label="Cancel"
                                            onclick={handleMassEditCancel}
                                        ></lightning-button>
                                        <lightning-button
                                            label="Apply"
                                            variant="brand"
                                            onclick={handleMassEditApply}
                                        ></lightning-button>
                                    </lightning-layout>
                                </div>
                            </lightning-layout-item>
                        </template>
                    </lightning-layout>
                </div>
            </template>
        </lightning-layout>
    </section>
</template>
